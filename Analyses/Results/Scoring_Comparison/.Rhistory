#######################
#     Load Files      #
#######################
setwd("../../Data_Files")
#load in genepop file as genind object with 2 pops - scored by us vs. scored
#by the Griffith lab
ZAIN_og_genind <- read.genepop("Adegenet_Files/Garden_Wild/ZAIN_og_garden_wild.gen", ncode = 3)
library(adegenet)
library(diveRsity)
#######################
#     Load Files      #
#######################
setwd("../../Data_Files")
#load in genepop file as genind object with 2 pops - scored by us vs. scored
#by the Griffith lab
ZAIN_og_genind <- read.genepop("Adegenet_Files/Garden_Wild/ZAIN_og_garden_wild.gen", ncode = 3)
#######################
#     Load Files      #
#######################
setwd("../../Data_Files")
#load in genepop file as genind object with 2 pops - scored by us vs. scored
#by the Griffith lab
ZAIN_og_genind <- read.genepop("Adegenet_Files/ZAIN_og_garden_wild.gen", ncode = 3)
#load in genepop file as genind object
ZAIN_og_genind <- read.genepop("Adegenet_Files/ZAIN_og_allpop.gen", ncode = 3)
table(ZAIN_og_genind@pop)
seppop(ZAIN_og_genind)[1:10]
repool(seppop(ZAIN_og_genind)[1:10])
#reorg genind object to have just garden vs. wild
ZAIN_og_garden_genind <- repool(seppop(ZAIN_og_genind)[1:10])
levels(ZAIN_og_garden_genind@pop) <- rep("Garden", 10)
table(ZAIN_og_garden_genind@pop)
#create wild genind object
ZAIN_og_wild_genind <- repool(seppop(ZAIN_og_genind)[11:35])
table(ZAIN_og_wild_genind@pop)
#create wild genind object
ZAIN_og_wild_genind <- repool(seppop(ZAIN_og_genind)[11:35])
levels(ZAIN_og_wild_genind@pop) <- rep("Wild",25)
#repool to create one genind object
ZAIN_og_garden_wild_genind <- repool(ZAIN_og_garden_genind,
ZAIN_og_wild_genind)
table(ZAIN_og_garden_wild_genind@pop)
#convert to genpop
ZAIN_og_genpop <- genind2genpop(ZAIN_og_garden_wild_genind)
#load rebinned genepop file as a genind object
ZAIN_rebinned_genind <- read.genepop("Adegenet_Files/ZAIN_rebinned_allpop.gen", ncode = 3)
repool(seppop(ZAIN_rebinned_genind)[1:10])
##reorg genind object to have just garden vs. wild
#create garden genind object
ZAIN_rebinned_garden_genind <- repool(seppop(ZAIN_rebinned_genind)[1:10])
levels(ZAIN_rebinned_garden_genind@pop) <- rep("Garden",10)
##reorg genind object to have just garden vs. wild
#create garden genind object
ZAIN_rebinned_garden_genind <- repool(seppop(ZAIN_rebinned_genind)[1:10])
levels(ZAIN_rebinned_garden_genind@pop) <- rep("Garden",10)
#create wild genind object
ZAIN_rebinned_wild_genind <- repool(seppop(ZAIN_rebinned_genind)[11:35])
levels(ZAIN_rebinned_wild_genind@pop) <- rep("Wild", 25)
#create repooled object
ZAIN_rebinned_garden_wild_genind <- repool(ZAIN_rebinned_garden_genind,
ZAIN_rebinned_wild_genind)
#convert to genepop
ZAIN_rebinned_genpop <- genind2genpop(ZAIN_rebinned_garden_wild_genind)
#create a list of loci
loci_list <- colnames(ZAIN_og_df)
#load in file with 2 pops - scored in 2021 (garden) and scored in 2011 (wild)
ZAIN_og_df <- read.csv("Data_Frames/ZAIN_og_allpop_df.csv")
#create a list of loci
loci_list <- colnames(ZAIN_og_df)
#clean list to just locus name
clean_loci <- unique(gsub("\\..*","",loci)[4:25])
#clean list to just locus name
clean_loci <- unique(gsub("\\..*","",loci_list)[4:25])
setwd("../Analyses/Results/Scoring_Comparison")
pdf("ZAIN_scoring_comparison_barplots.pdf",width=20,height=9)
#loop to compare scoring between 2021 Scoring and 2011 Scoring
for(a in clean_loci){
#create data frame of each locus
ZAIN_scoring <- ZAIN_og_genpop[,which(grepl(a,colnames(ZAIN_og_genpop@tab)))]@tab
for(p in 1:2) ZAIN_scoring[p,] <- ZAIN_scoring[p,]/sum(ZAIN_scoring[p,])
#reorder data frame
ZAIN_scoring <- ZAIN_scoring[,sort(colnames(ZAIN_scoring))]
#now plot
ZAIN_barplot <- barplot(ZAIN_scoring, las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"),
legend.text =  c("2021","2011"), ylim = c(0,1), main = paste0(a),
names = gsub("^.*\\.","",colnames(ZAIN_scoring)))
}
dev.off()
############################################################
#     Scoring Comparison Following Rebinning Analysis      #
############################################################
##Code to plot ZAIN genind objects following rebinning analysis was performed
#create pdf
pdf("ZAIN_scoring_comparison_barplots_post_rebinning.pdf",width=20,height=9)
#loop to compare scoring between 2021 Scoring and 2011 Scoring
for(a in clean_loci){
#create data frame of each locus
ZAIN_scoring <- ZAIN_rebinned_genpop[,which(grepl(a,colnames(ZAIN_rebinned_genpop@tab)))]@tab
#loop to standardize score count by percent for each group - wild and garden individuals
for(p in 1:2) ZAIN_scoring[p,] <- ZAIN_scoring[p,]/sum(ZAIN_scoring[p,])
#reorder data frame for alleles to be plotted in numerical order
ZAIN_scoring <- ZAIN_scoring[,sort(colnames(ZAIN_scoring))]
#plot barplots by locus
ZAIN_barplot <- barplot(ZAIN_scoring, las = 2, beside = TRUE, col = c("darkgreen", "darkseagreen1"),
legend.text =  c("2021","2011"), ylim = c(0,1), main = paste0(a),
names = gsub("^.*\\.","",colnames(ZAIN_scoring)))
}
dev.off()
sessionInfo()
