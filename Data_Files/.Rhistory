#
setwd("C:/Users/eschumacher/Documents/GitHub/GCC_QUAC_ZAIN/Data_Files")
#load genind object
ZAIN_rebinned_genind <- read.genepop("Adegenet_Files/ZAIN_rebinned_allpop_clean.gen", ncode = 3)
#########################
#     Load in Files     #
#########################
#set working directory
setwd("../../Data_Files")
#data file lists
sp_genind_list <- list.files(path = "Adegenet_Files", pattern = "clean.gen")
##run PCA on just Quercus acerifolia individuals
#read in genepop files as a genind object
QUAC_wK_gen <- read.genepop("Adegenet_Files/QUAC_allpop_clean.gen", ncode = 3)
library(adegenet)
##run PCA on just Quercus acerifolia individuals
#read in genepop files as a genind object
QUAC_wK_gen <- read.genepop("Adegenet_Files/QUAC_allpop_clean.gen", ncode = 3)
##run PCA on just Quercus acerifolia individuals
#read in genepop files as a genind object
QUAC_wK_gen <- read.genepop("Adegenet_Files/QUAC_wK_allpop_clean.gen", ncode = 3)
QUAC_wk_wild_gen <- repool(seppop(QUAC_wK_gen)[18:22])
#read in data frame
QUAC_wk_df <- read.csv("Data_Frames/QUAC_allpop_clean_df.csv")
QUAC_wk_wild_df <- QUAC_wk_df[QUAC_wk_df$Garden_Wild == "Wild",]
#name rows in the genind object
rownames(QUAC_wk_wild_gen@tab) <- QUAC_wk_wild_df[,1]
#name pops
levels(QUAC_wk_wild_gen@pop) <- unique(QUAC_wk_wild_df[,2])
#create tab object for genind
QUAC_wk_wild_tab <- tab(QUAC_wk_wild_gen, freq=TRUE, NA.method="mean")
#run PCA
QUAC_wk_wild_PCA <- dudi.pca(QUAC_wk_wild_tab, scale = FALSE, nf = 2, scannf = FALSE)
#create PCA data frame
QUAC_wk_wild_PCA_df <- as.data.frame(cbind(as.numeric(QUAC_wk_wild_PCA$li$Axis1),
as.numeric(QUAC_wk_wild_PCA$li$Axis2),
QUAC_wk_wild_df[,2]))
colnames(QUAC_wk_wild_PCA_df) <- c("Axis1","Axis2","Pop")
#calculate % variation explained by axis
QUAC_wild_pc1 <- signif(((QUAC_wk_wild_PCA$eig[1])/sum(QUAC_wk_wild_PCA$eig))*100, 3)
QUAC_wild_pc2 <- signif(((QUAC_wk_wild_PCA$eig[2])/sum(QUAC_wk_wild_PCA$eig))*100, 3)
ggplot(QUAC_wk_wild_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Pop)) + geom_point() +
stat_ellipse() +
xlab(paste0("PC1 (", QUAC_wild_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_wild_pc2, "%)")) +
theme_bw() +
scale_color_manual(values=hcl.colors(n = length(unique(QUAC_wk_wild_PCA_df$Pop)), palette = "viridis"))
library(ggplot2)
ggplot(QUAC_wk_wild_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Pop)) + geom_point() +
stat_ellipse() +
xlab(paste0("PC1 (", QUAC_wild_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_wild_pc2, "%)")) +
theme_bw() +
scale_color_manual(values=hcl.colors(n = length(unique(QUAC_wk_wild_PCA_df$Pop)), palette = "viridis"))
###############
#     PCA     #
###############
setwd("G:/Shared drives/Emily_Schumacher/Project_Folders/GCC_QUAC_ZAIN/Data_Files")
#load genind objects
QUAC_wK_PCA_genind <- read.genepop("Adegenet_Files/QUAC_wK_garden_allwildpop_clean.gen", ncode = 3)
ZAIN_rebinned_PCA_genind <- read.genepop("Adegenet_Files/ZAIN_rebinned_garden_wild_clean.gen", ncode = 3)
levels(QUAC_wK_PCA_genind@pop) <- c("Garden", unique(QUAC_wK_df$Pop)[18:22])
levels(ZAIN_rebinned_PCA_genind@pop) <- c("Garden", "Wild")
#load in data frames
QUAC_wK_df <- read.csv("Data_Frames/QUAC_wK_pop_df.csv")
ZAIN_rebinned_df <- read.csv("Data_Frames/ZAIN_pop_df.csv")
####Run PCA code - QUAC
#create tab file
QUAC_wK_tab <- tab(QUAC_wK_PCA_genind, freq=TRUE, NA.method="mean")
#run PCA
QUAC_wK_PCA <- dudi.pca(QUAC_wK_tab, scale = FALSE, nf = 2, scannf = FALSE)
#create PCA data frame
QUAC_wK_PCA_df <- as.data.frame(cbind(as.numeric(QUAC_wK_PCA$li$Axis1),
as.numeric(QUAC_wK_PCA$li$Axis2), QUAC_wK_df$Pop_Type, QUAC_wK_df$Variety))
colnames(QUAC_wK_PCA_df) <- c("Axis1", "Axis2", "Pop_Type", "Variety")
#calculate % variation explained by axis
QUAC_pc1 <- signif(((QUAC_wK_PCA$eig[1])/sum(QUAC_wK_PCA$eig))*100, 3)
QUAC_pc2 <- signif(((QUAC_wK_PCA$eig[2])/sum(QUAC_wK_PCA$eig))*100, 3)
####Run PCA code - ZAIN
#create tab object for genind
ZAIN_rebinned_tab <- tab(ZAIN_rebinned_PCA_genind, freq=TRUE, NA.method="mean")
#run PCA
ZAIN_rebinned_PCA <- dudi.pca(ZAIN_rebinned_tab, scale = FALSE, nf = 2, scannf = FALSE)
#create PCA data frame
ZAIN_PCA_df <- as.data.frame(cbind(as.numeric(ZAIN_rebinned_PCA$li$Axis1),
as.numeric(ZAIN_rebinned_PCA$li$Axis2), ZAIN_rebinned_df$Pop_Type,
ZAIN_rebinned_df$Variety))
colnames(ZAIN_PCA_df) <- c("Axis1","Axis2","Pop_Type", "Variety")
#calculate % variation explained by axis
ZAIN_pc1 <- signif(((ZAIN_rebinned_PCA$eig[1])/sum(ZAIN_rebinned_PCA$eig))*100, 3)
ZAIN_pc2 <- signif(((ZAIN_rebinned_PCA$eig[2])/sum(ZAIN_rebinned_PCA$eig))*100, 3)
pdf("../Analyses/Results/Clustering/ZAIN_PCA.pdf", width = 10, height = 8)
dev.off()
ggplot(ZAIN_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Pop_Type,
shape = Variety)) +
geom_point(size = 3) +
xlab(paste0("PC1 (", ZAIN_pc1, "%)")) +
ylab(paste0("PC2 (", ZAIN_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("mediumseagreen", "black")) +
scale_shape_manual(values = c(16,18, 3))
ggplot(ZAIN_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Pop_Type,
shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", ZAIN_pc1, "%)")) +
ylab(paste0("PC2 (", ZAIN_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("mediumseagreen", "black")) +
scale_shape_manual(values = c(16,18, 3))
pdf("../Analyses/Results/Clustering/ZAIN_PCA.pdf", width = 10, height = 8)
ggplot(ZAIN_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Pop_Type,
shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", ZAIN_pc1, "%)")) +
ylab(paste0("PC2 (", ZAIN_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("mediumseagreen", "black")) +
scale_shape_manual(values = c(16,18, 3))
dev.off()
setwd("C:/Users/eschumacher/Documents/GitHub/GCC_QUAC_ZAIN/Data_Files")
##QUAC
pdf("../Analyses/Results/Clustering/QUAC_PCA.pdf", width = 10, height = 8)
ggplot(QUAC_wK_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Pop_Type, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("mediumseagreen", "black")) +
scale_shape_manual(values = c(16,17,15,19,3,4))
dev.off()
##ZAIN
pdf("../Analyses/Results/Clustering/ZAIN_PCA.pdf", width = 10, height = 8)
ggplot(ZAIN_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Pop_Type,
shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", ZAIN_pc1, "%)")) +
ylab(paste0("PC2 (", ZAIN_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("mediumseagreen", "black")) +
scale_shape_manual(values = c(16,18, 3))
dev.off()
##QUAC
pdf("../Analyses/Results/Clustering/QUAC_PCA.pdf", width = 10, height = 8)
##QUAC
pdf("../Analyses/Results/Clustering/QUAC_PCA.pdf", width = 10, height = 8)
ggplot(QUAC_wK_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Pop_Type, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("mediumseagreen", "black")) +
scale_shape_manual(values = c(16,17,15,19,3,4))
dev.off()
#####final PCA figures for publishing
#load genind objects
QUAC_wK_PCA_genind <- read.genepop("Adegenet_Files/QUAC_wK_allpop_clean.gen", ncode = 3)
table(QUAC_wK_PCA_genind@pop)
##reorganize genind objects
#QUAC
QUAC_garden_gen <- seppop(QUAC_wK_PCA_genind)[1:17]
levels(QUAC_garden_gen@pop) <- rep("Garden", length(levels(QUAC_garden_gen)))
#create wild genind object
QUAC_wild_gen <- seppop(QUAC_garden_gen)[18:22]
levels(QUAC_wild_gen@pop) <- rep("Wild", length(QUAC_wild_gen))
##reorganize genind objects
#QUAC
#create garden genind object
QUAC_garden_gen <- seppop(QUAC_wK_PCA_genind)[[1:17]]
##reorganize genind objects
#QUAC
#create garden genind object
QUAC_garden_gen <- repool(seppop(QUAC_wK_PCA_genind)[1:17])
levels(QUAC_garden_gen@pop) <- rep("Garden", length(levels(QUAC_garden_gen)))
##reorganize genind objects
#QUAC
#create garden genind object
QUAC_garden_gen <- repool(seppop(QUAC_wK_PCA_genind)[1:17])
table(QUAC_garden_gen@pop)
length(levels(QUAC_garden_gen))
levels(QUAC_garden_gen@pop) <- rep("Garden", length(levels(QUAC_garden_gen@pop)))
#create wild genind object
QUAC_wild_gen <- seppop(QUAC_garden_gen)[18:22]
levels(QUAC_wild_gen@pop) <- rep("Wild", length(levels(QUAC_wild_gen@pop)))
#create wild genind object
QUAC_wild_gen <- repool(seppop(QUAC_garden_gen)[18:22])
levels(QUAC_wild_gen@pop) <- rep("Wild", length(levels(QUAC_wild_gen@pop)))
#create wild genind object
QUAC_wild_gen <- repool(seppop(QUAC_wK_PCA_genind)[18:22])
levels(QUAC_wild_gen@pop) <- rep("Wild", length(levels(QUAC_wild_gen@pop)))
ZAIN_rebinned_PCA_df <- read.csv("Data_Frames/ZAIN_rebinned_allpop_clean_df.csv")
#load genind objects
QUAC_wK_PCA_genind <- read.genepop("Adegenet_Files/QUAC_wK_allpop_clean.gen", ncode = 3)
ZAIN_rebinned_PCA_genind <- read.genepop("Adegenet_Files/ZAIN_rebinned_allpop_clean.gen", ncode = 3)
#load data frames
QUAC_wK_PCA_df <- read.csv("Data_Frames/QUAC_allpop_clean_df.csv")
ZAIN_rebinned_PCA_df <- read.csv("Data_Frames/ZAIN_rebinned_allpop_clean_df.csv")
table(QUAC_wK_PCA_genind@pop)
##reorganize genind objects
#QUAC - combine all garden collections into one population in genind
QUAC_garden_gen <- repool(seppop(QUAC_wK_PCA_genind)[1:17])
#now repool with wild individuals
QUAC_garden_allwildpop_PCA_genind <- repool(QUAC_garden_gen, repool(seppop(QUAC_wK_PCA_genind)[18:22]))
QUAC_garden_allwildpop_PCA_genind
table(QUAC_garden_allwildpop_PCA_genind@pop)
##reorganize genind objects
#QUAC - combine all garden collections into one population in genind
QUAC_garden_gen <- repool(seppop(QUAC_wK_PCA_genind)[1:17])
levels(QUAC_garden_gen@pop) <- rep("Garden", length(levels(QUAC_garden_gen@pop)))
##reorganize genind objects
#QUAC - combine all garden collections into one population in genind
QUAC_garden_gen <- repool(seppop(QUAC_wK_PCA_genind)[1:17])
levels(QUAC_garden_gen@pop) <- rep("Garden", length(levels(QUAC_garden_gen@pop)))
table(QUAC_garden_gen@pop)
unique(QUAC_wK_PCA_df$Pop)
unique(QUAC_wK_PCA_df$Pop)[18:22]
#create wild pop QUAC genind
QUAC_wild_gen <- repool(seppop(QUAC_wK_PCA_genind)[18:22])
levels(QUAC_wild_gen@pop) <- unique(QUAC_wK_PCA_df$Pop)[18:22]
#now repool with wild individuals
QUAC_garden_allwildpop_PCA_genind <- repool(QUAC_garden_gen, QUAC_wild_gen)
table(QUAC_garden_allwildpop_PCA_genind@pop)
#reorganize ZAIN
ZAIN_garden_gen <- repool(seppop(ZAIN_rebinned_PCA_genind)[1:10])
levels(ZAIN_garden_gen@pop) <- rep("Garden", length(levels(ZAIN_rebinned_PCA_genind@pop)))
#reorganize wild
ZAIN_wild_gen <- repool(seppop(ZAIN_rebinned_PCA_genind)[11:35])
levels(ZAIN_wild_gen@pop) <- rep("Wild", length(levels(ZAIN_wild_gen@pop)))
ZAIN_rebinned_PCA_genind
seppop(ZAIN_rebinned_PCA_genind)[11:35]
length(levels(ZAIN_rebinned_PCA_genind@pop))
#reorganize wild
ZAIN_wild_gen <- repool(seppop(ZAIN_rebinned_PCA_genind)[11:34])
levels(ZAIN_wild_gen@pop) <- rep("Wild", length(levels(ZAIN_wild_gen@pop)))
#repool into one genind
ZAIN_garden_wild_PCA_genind <- repool(ZAIN_garden_gen, ZAIN_wild_gen)
####Run PCA code - QUAC
#create tab file
QUAC_wK_tab <- tab(QUAC_garden_allwildpop_PCA_genind, freq=TRUE, NA.method="mean")
#run PCA
QUAC_wK_PCA <- dudi.pca(QUAC_wK_tab, scale = FALSE, nf = 2, scannf = FALSE)
#create PCA data frame
QUAC_wK_PCA_df <- as.data.frame(cbind(as.numeric(QUAC_wK_PCA$li$Axis1),
as.numeric(QUAC_wK_PCA$li$Axis2), QUAC_wK_df$Pop_Type, QUAC_wK_df$Variety))
QUAC_wK_df
table(QUAC_garden_allwildpop_PCA_genind@pop)
table(QUAC_garden_allwildpop_PCA_genind@pop)[``]
table(QUAC_garden_allwildpop_PCA_genind@pop)[1]
as.numeric(table(QUAC_garden_allwildpop_PCA_genind@pop)[1])
length(row.names(QUAC_garden_gen@tab))
#create PCA data frame
QUAC_wK_PCA_df <- as.data.frame(cbind(as.numeric(QUAC_wK_PCA$li$Axis1),
as.numeric(QUAC_wK_PCA$li$Axis2),
c(rep("Garden", length(row.names(QUAC_garden_gen@tab)),
rep("Wild", length(row.names(QUAC_wild_gen@tab)))))))
#add data organization to the data frame
QUAC_wK_PCA_df$Pop_Type <- c(rep("Garden", length(row.names(QUAC_garden_gen@tab)),
rep("Wild", length(row.names(QUAC_wild_gen@tab))))))
#add data organization to the data frame
QUAC_wK_PCA_df$Pop_Type <- c(rep("Garden", length(row.names(QUAC_garden_gen@tab)),
rep("Wild", length(row.names(QUAC_wild_gen@tab)))))
rep("Garden", length(row.names(QUAC_garden_gen@tab))
)
rep("Garden", length(row.names(QUAC_garden_gen@tab)))
rep("Wild", length(row.names(QUAC_wild_gen@tab)))
#add data organization to the data frame
QUAC_wK_PCA_df$Pop_Type <- c(rep("Garden", length(row.names(QUAC_garden_gen@tab))),
rep("Wild", length(row.names(QUAC_wild_gen@tab))))
View(QUAC_wK_PCA_df)
#create PCA data frame
QUAC_wK_PCA_df <- as.data.frame(cbind(as.numeric(QUAC_wK_PCA$li$Axis1),
as.numeric(QUAC_wK_PCA$li$Axis2)))
unique(QUAC_wK_PCA_df$Pop)[18:22]
QUAC_wK_PCA_df$Pop
#load data frames
QUAC_wK_PCA_df <- read.csv("Data_Frames/QUAC_allpop_clean_df.csv")
QUAC_wK_PCA_df
unique(QUAC_wK_PCA_df$Pop)[18:22]
levels(QUAC_wild_gen@pop)[1]
as.numeric(table(QUAC_wild_gen@pop)[1])
#add wild pop info
QUAC_wK_PCA_df$Variety <- c(rep("Garden", length(row.names(QUAC_garden_gen@tab))),
rep(levels(QUAC_wild_gen@pop)[1],as.numeric(table(QUAC_wild_gen@pop)[1])),
rep(levels(QUAC_wild_gen@pop)[2],as.numeric(table(QUAC_wild_gen@pop)[2])),
rep(levels(QUAC_wild_gen@pop)[3],as.numeric(table(QUAC_wild_gen@pop)[3])),
rep(levels(QUAC_wild_gen@pop)[4],as.numeric(table(QUAC_wild_gen@pop)[4])),
rep(levels(QUAC_wild_gen@pop)[5],as.numeric(table(QUAC_wild_gen@pop)[5]))
)
#load data frames
QUAC_wK_PCA_df <- read.csv("Data_Frames/QUAC_allpop_clean_df.csv")
ZAIN_rebinned_PCA_df <- read.csv("Data_Frames/ZAIN_rebinned_allpop_clean_df.csv")
#create PCA data frame
QUAC_PCA_df <- as.data.frame(cbind(as.numeric(QUAC_wK_PCA$li$Axis1),
as.numeric(QUAC_wK_PCA$li$Axis2)))
View(QUAC_PCA_df)
#add data organization to the data frame - pop type (wild vs. garden)
QUAC_PCA_df$Pop_Type <- c(rep("Garden", length(row.names(QUAC_garden_gen@tab))),
rep("Wild", length(row.names(QUAC_wild_gen@tab))))
#add wild pop info
QUAC_PCA_df$Variety <- c(rep("Garden", length(row.names(QUAC_garden_gen@tab))),
rep(levels(QUAC_wild_gen@pop)[1],as.numeric(table(QUAC_wild_gen@pop)[1])),
rep(levels(QUAC_wild_gen@pop)[2],as.numeric(table(QUAC_wild_gen@pop)[2])),
rep(levels(QUAC_wild_gen@pop)[3],as.numeric(table(QUAC_wild_gen@pop)[3])),
rep(levels(QUAC_wild_gen@pop)[4],as.numeric(table(QUAC_wild_gen@pop)[4])),
rep(levels(QUAC_wild_gen@pop)[5],as.numeric(table(QUAC_wild_gen@pop)[5]))
)
#name columns
colnames(QUAC_wK_PCA_df) <- c("Axis1", "Axis2", "Pop_Type", "Variety")
#calculate % variation explained by axis
QUAC_pc1 <- signif(((QUAC_wK_PCA$eig[1])/sum(QUAC_wK_PCA$eig))*100, 3)
QUAC_pc2 <- signif(((QUAC_wK_PCA$eig[2])/sum(QUAC_wK_PCA$eig))*100, 3)
ggplot(QUAC_wK_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Pop_Type, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("mediumseagreen", "black")) +
scale_shape_manual(values = c(16,17,15,19,3,4))
#name columns
colnames(QUAC_PCA_df) <- c("Axis1", "Axis2", "Pop_Type", "Variety")
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Pop_Type, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("mediumseagreen", "black")) +
scale_shape_manual(values = c(16,17,15,19,3,4))
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Pop_Type, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "mediumseagreen")) +
scale_shape_manual(values = c(16,17,15,19,3,4))
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Variety, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "red", "darkorange3", "coral", "deeppink4", "purple")) +
scale_shape_manual(values = c(16,17,15,19,3,4))
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Variety, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "red", "purple", "coral", "deeppink4", "pink")) +
scale_shape_manual(values = c(16,17,15,19,3,4))
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Variety, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "red", "purple", "coral", "deeppink4", "pink")) +
scale_shape_manual(values = c(16,17,15,19,20,24))
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Variety, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "red", "purple", "coral", "deeppink4", "pink")) +
scale_shape_manual(values = c(16,17,15,19,5,24))
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Variety, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "red", "purple", "coral", "deeppink4", "pink")) +
scale_shape_manual(values = c(16,17,15,19,18,24))
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Variety, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "red", "purple", "coral", "deeppink4", "pink")) +
scale_shape_manual(values = c(16,17,15,19,18,14))
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Variety, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "red", "purple", "coral", "deeppink4", "pink")) +
scale_shape_manual(values = c(16,17,15,19,18,8))
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Variety, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "red", "purple", "coral", "deeppink4", "pink")) +
scale_shape_manual(values = c(8,17,15,19,18,16))
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Variety, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "red", "purple", "coral", "deeppink4", "pink")) +
scale_shape_manual(values = c(23,17,15,19,18,16))
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Variety, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "red", "purple", "coral", "deeppink4", "pink")) +
scale_shape_manual(values = c(20,17,15,19,18,16))
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Variety, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "red", "purple", "coral", "deeppink4", "pink")) +
scale_shape_manual(values = c(20,17,15,19,18,16))
dev.off()
#plot PCA
pdf("../Analyses/Results/Clustering/QUAC_PCA.pdf", width = 10, height = 8)
ggplot(QUAC_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Variety, shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", QUAC_pc1, "%)")) +
ylab(paste0("PC2 (", QUAC_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("black", "red", "purple", "coral", "deeppink4", "pink")) +
scale_shape_manual(values = c(20,17,15,19,18,16))
dev.off()
####Run PCA code - ZAIN
#create tab object for genind
ZAIN_rebinned_tab <- tab(ZAIN_garden_wild_PCA_genind, freq=TRUE, NA.method="mean")
#run PCA
ZAIN_rebinned_PCA <- dudi.pca(ZAIN_rebinned_tab, scale = FALSE, nf = 2, scannf = FALSE)
ZAIN_PCA_df
#create PCA data frame
ZAIN_PCA_df <- as.data.frame(cbind(as.numeric(ZAIN_rebinned_PCA$li$Axis1),
as.numeric(ZAIN_rebinned_PCA$li$Axis2)))
View(ZAIN_PCA_df)
ZAIN_garden_wild_PCA_genind
levels(ZAIN_garden_wild_PCA_genind@pop)
levels(ZAIN_garden_wild_PCA_genind@pop)[1]
ZAIN_PCA_df$Pop_Type <- c(rep(levels(ZAIN_garden_wild_PCA_genind@pop)[1],
as.numeric(table(ZAIN_garden_wild_PCA_genind)[1])),
rep(levels(ZAIN_garden_wild_PCA_genind@pop)[2],
as.numeric(table(ZAIN_garden_wild_PCA_genind)[2])))
as.numeric(table(ZAIN_garden_wild_PCA_genind)[1])
ZAIN_PCA_df$Pop_Type <- c(rep(levels(ZAIN_garden_wild_PCA_genind@pop)[1],
as.numeric(table(ZAIN_garden_wild_PCA_genind@pop)[1])),
rep(levels(ZAIN_garden_wild_PCA_genind@pop)[2],
as.numeric(table(ZAIN_garden_wild_PCA_genind@pop)[2])))
#load population reference for varieties of ZAIN
ZAIN_pop_df <- read.csv("Data_Frames/ZAIN_pop_df.csv")
#add variety
ZAIN_PCA_df$Variety <- ZAIN_pop_df$Variety
colnames(ZAIN_PCA_df) <- c("Axis1","Axis2","Pop_Type", "Variety")
#name columns of the  PCA data frame
colnames(ZAIN_PCA_df) <- c("Axis1","Axis2","Pop_Type", "Variety")
#calculate % variation explained by axis
ZAIN_pc1 <- signif(((ZAIN_rebinned_PCA$eig[1])/sum(ZAIN_rebinned_PCA$eig))*100, 3)
ZAIN_pc2 <- signif(((ZAIN_rebinned_PCA$eig[2])/sum(ZAIN_rebinned_PCA$eig))*100, 3)
ggplot(ZAIN_PCA_df, aes(as.numeric(Axis1), as.numeric(Axis2), col = Pop_Type,
shape = Variety)) +
geom_point(size = 4) +
xlab(paste0("PC1 (", ZAIN_pc1, "%)")) +
ylab(paste0("PC2 (", ZAIN_pc2, "%)")) +
theme_bw() +
scale_color_manual(values = c("mediumseagreen", "black")) +
scale_shape_manual(values = c(16,18, 3))
