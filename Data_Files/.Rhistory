###################################
#     Plot structure diagrams     #
###################################
# Reading in K7_subset file, an updated version of the CLUMPAK K7.output file.
# Comes from JuneSubset ipyrad/STRUCTURE run
# This contains samples in their presented order, and has capillaris and one Troy Peak sample removed from file
setwd("../../Data_Files")
##create a data frame list
QUAC_wk_list <- list.files(path = "Structure_Files/QUAC_allpop_wK", pattern = ".csv")
QUAC_pop_list <- list()
for(k in 1:length(QUAC_wk_list)){
QUAC_k <- read.csv(paste0("Structure_Files/QUAC_allpop_wK/",QUAC_wk_list[[k]]))
QUAC_pop <- unique(QUAC_k$Population)
#for(pop in 1:length(QUAC_pop)){
#  QUAC_pop_list[[pop]] <- which(QUAC_k$Population == QUAC_pop[[pop]],)[length(QUAC_k[QUAC_k$Population == QUAC_pop[[pop]],][,1])]
QUAC_k_ready <- QUAC_k[,-c(1:2)]
colors <- viridis::viridis(k+1)
pdf(paste0("../Analyses/Results/Clustering/QUAC_allpop_wK_STR_k",k+1,".pdf"), width = 20, height = 10)
# Graphing parameters
par(mar=c(7,2,10,1)+0.1, mgp = c(3,1,1))
for(i in 1:length(QUAC_k_ready)){
if(i==1){
#Initial barplot
barplot(QUAC_k_ready[,i], xlim=c(0,length(QUAC_k_ready[,1])), horiz=F, beside=F, col=colors[i], axisnames=T, space=0, yaxt= "n", main=paste0("K = ", k+1),
border = NA)
off.value <- QUAC_k_ready[,i]
}else{
# Subsequent barplots with offset
barplot(QUAC_k_ready[,i], offset=off.value, add=T, beside=F, xlim=c(0,length(QUAC_k_ready[,1])), horiz=F, col=colors[i], yaxt= "n", space=0,
border = NA)
off.value <- off.value + QUAC_k_ready[,i]
#}
}
}
dev.off()
}
##create a data frame list
QUAC_wk_list <- list.files(path = "Structure_Files/QUAC_allpop_wK", pattern = ".csv")
QUAC_pop_list <- list()
for(k in 1:length(QUAC_wk_list)){
QUAC_k <- read.csv(paste0("Structure_Files/QUAC_allpop_wK/",QUAC_wk_list[[k]]))
QUAC_pop <- unique(QUAC_k$Population)
#for(pop in 1:length(QUAC_pop)){
#  QUAC_pop_list[[pop]] <- which(QUAC_k$Population == QUAC_pop[[pop]],)[length(QUAC_k[QUAC_k$Population == QUAC_pop[[pop]],][,1])]
QUAC_k_ready <- QUAC_k[,-c(1:2)]
colors <- viridis::viridis(k+1)
pdf(paste0("../Analyses/Results/Clustering/QUAC_allpop_wK_STR_k",k+1,".pdf"), width = 20, height = 10)
# Graphing parameters
par(mar=c(7,2,10,1)+0.1, mgp = c(3,1,1))
for(i in 1:length(QUAC_k_ready)){
if(i==1){
#Initial barplot
barplot(QUAC_k_ready[,i], xlim=c(0,length(QUAC_k_ready[,1])), horiz=F, beside=F, col=colors[i], axisnames=T, space=0, yaxt= "n", main=paste0("K = ", k+1),
border = NA)
off.value <- QUAC_k_ready[,i]
}else{
# Subsequent barplots with offset
barplot(QUAC_k_ready[,i], offset=off.value, add=T, beside=F, xlim=c(0,length(QUAC_k_ready[,1])), horiz=F, col=colors[i], yaxt= "n", space=0,
border = NA)
off.value <- off.value + QUAC_k_ready[,i]
#}
}
}
dev.off()
}
