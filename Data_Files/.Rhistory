##run loop to generate allelic capture table
#the outer loop is calculating how many copies of each allele in each category exists
#the inner loop is calculating the percent capture of each allele in each frequency category
for(sp in 1:length(species_list)){  #loop over every scenario
for(ndrop in c(0,2)){     #loop to include very rare or not
#ndrop or not
if(ndrop == 0) n_drop_file <- "_ndrop0"
if(ndrop == 2) n_drop_file <- "_ndrop2"
#load genepop files as genind objects
sp_genind_temp <- read.genepop(paste0("Adegenet_Files/",sp_genind_list[[sp]]), ncode = 3)
#load data frames
sp_df_temp <- read.csv(paste0("CSV_Files/", sp_df_list[[sp]]))
##organize genind object
#add individual names to each row of the tab
rownames(sp_genind_temp@tab) <- sp_df_temp[,1]
#add pop names to the genind object
levels(sp_genind_temp@pop) <- unique(sp_df_temp$Pop)
##organize into pops - garden
#sp_garden_genind <- repool(seppop(sp_genind_temp)[pop_list[[sp]]])
#rename pops to be garden only
#levels(sp_garden_genind@pop) <- rep("Garden", length(levels(sp_garden_genind@pop)))
sp_garden_ind <- sum(table(sp_genind_temp@pop)[pop_list[[sp]]])
sp_garden_genind <- sp_genind_temp[1:sp_garden_ind,]
levels(sp_garden_genind@pop) <- rep("Garden", length(levels(sp_garden_genind@pop)))
##organize into pop types
#separate into wild genind object
#sp_wild_genind <- repool(seppop(sp_genind_temp)[pop_list[[sp+5]]])
#rename
#levels(sp_wild_genind@pop) <- rep("Wild", length(levels(sp_wild_genind@pop)))
sp_wild_ind <- sum(table(sp_genind_temp@pop)[pop_list[[sp+5]]])
sp_wild_genind <- sp_genind_temp[(sp_garden_ind+1):(sp_garden_ind+sp_wild_ind),]
levels(sp_wild_genind@pop) <- rep("Wild", length(levels(sp_wild_genind@pop)))
#repool genind objects
sp_garden_wild_genind <- repool(sp_garden_genind, sp_wild_genind)
#convert the wild genind object to a genpop object
sp_wild_genpop <- genind2genpop(seppop(sp_garden_wild_genind)[2]$Wild)
#create documents for comparison
#n_ind_W <- nrow(sp_wild_genind@tab);  n_ind_G <- nrow(sp_garden_genind@tab);
sp_alleles_cap <- colSums(seppop(sp_garden_wild_genind)[[1]]@tab,na.rm=T)
#first calculate the frequency categories of alleles in the wild individuals
sp_allele_cat <- get.allele.cat(sp_wild_genpop, 1, 1, n_ind_W, n_drop = ndrop, glob_only = TRUE)
#exterior loop to look at alleles by frequency category
#interior loop to alleles by "duplication" amount - how many copies of each allele
for(cat in 1:length(list_allele_cat)){
for(dup in 1:length(dup_reps)){
#calculating alleles that exist by allelic category
#sp_all_exist_df[dup, cat] <- sum(sp_wild_genpop@tab[sp_allele_cat[[cat]]] > dup_reps[[dup]])
#now determine how many wild alleles were captured per category
#sp_wild_cap_df[dup, cat] <- round(sum(sp_alleles_cap[sp_allele_cat[[cat]]] > dup_reps[[dup]])/length(sp_allele_cat[[cat]]),4)
#code to store as one data frame
#sp_allele_cap[dup, cat] <- paste0(signif((sp_wild_cap_df[dup,cat]*100),3), "%")
##try to add the individual rep
#save alleles existing
num_alleles_in_cat <- length(sp_allele_cat[[cat]])
#save each category
for(a in 1:num_alleles_in_cat){
num_rep_list[[cat]][a] <- sum(sp_garden_genind@tab[,sp_allele_cat[[cat]]][,a] > 0, na.rm=T)
}
sp_ind_rep_df[dup,cat] <- sum(num_rep_list[[cat]]>dup_reps[[dup]], na.rm = TRUE)/length(num_rep_list[[cat]])
}
}
#write out ind rep df
write.csv(sp_ind_rep_df, paste0("../Analyses/Results/Garden_Wild_Comparison/", species_list[[sp]], "_sp_ind_rep_df", n_drop_file, ".csv"))
#add loop to calculate diversity in ZAIN without small pops
if(sp == 3|sp == 4|sp == 5){
#loop to remove small pops from ZAIN and run diversity representation code
for(pop in 1:length(ZAIN_wild_red_list)){
##organize into pop types
#separate into wild genind object
sp_wild_red_genind <- repool(seppop(sp_genind_temp)[ZAIN_wild_red_list[[pop]]])
#rename
levels(sp_wild_red_genind@pop) <- rep("Wild", length(levels(sp_wild_red_genind@pop)))
#repool genind objects
sp_garden_wild_red_genind <- repool(sp_garden_genind, sp_wild_red_genind)
#convert the wild genind object to a genpop object
sp_wild_red_genpop <- genind2genpop(seppop(sp_garden_wild_red_genind)[2]$Wild)
#create documents for comparison
n_ind_W <- nrow(sp_wild_red_genind@tab);  n_ind_G <- nrow(sp_garden_genind@tab);
sp_alleles_red_cap <- colSums(seppop(sp_garden_wild_red_genind)[[1]]@tab,na.rm=T)
#first calculate the frequency categories of alleles in the wild individuals
sp_allele_red_cat <- get.allele.cat(sp_wild_red_genpop, 1, 1, n_ind_W, n_drop = ndrop, glob_only = TRUE)
#exterior loop to look at alleles by frequency category
#interior loop to alleles by "duplication" amount - how many copies of each allele
for(cat in 1:length(list_allele_cat)){
for(dup in 1:length(dup_reps)){
#calculating alleles that exist by allelic category in the wild
sp_all_red_exist_df[dup, cat] <- sum(sp_wild_red_genpop@tab[sp_allele_cat[[cat]]] > dup_reps[[dup]])
#now determine how many wild alleles were captured per category
sp_wild_red_cap_df[dup, cat] <- round(sum(sp_alleles_red_cap[sp_allele_red_cat[[cat]]] > dup_reps[[dup]])/length(sp_allele_red_cat[[cat]]),4)
#code to store as one data frame
sp_allele_red_cap[dup, cat] <- paste0(signif((sp_wild_red_cap_df[dup,cat]*100),3), "%")
}
}
}
#without ZAIN small pops - alleles existing
rownames(sp_all_red_exist_df) <- paste0(c(1:10), " or more copies")
colnames(sp_all_red_exist_df) <- list_allele_cat
#without ZAIN small pops - representing alleles
rownames(sp_wild_red_cap_df) <- paste0(c(1:10), " or more copies")
colnames(sp_wild_red_cap_df) <- list_allele_cat
#without ZAIN small pops - comparing wild allele representation ex situ
rownames(sp_allele_red_cap) <- paste0(c(1:10), " or more copies")
colnames(sp_allele_red_cap) <- list_allele_cat
#ind per df
rownames(sp_ind_per) <- paste0(c(1:10), " or more copies")
colnames(sp_ind_per) <- list_allele_cat
write.csv(sp_all_red_exist_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_all_exist2", n_drop_file, "_wo_smallpops.csv"))
write.csv(sp_wild_red_cap_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_wildcap2", n_drop_file, "_wo_smallpops.csv"))
write.csv(sp_allele_red_cap, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_all_cap2", n_drop_file, "_wo_smallpops.csv"))
}
##format tables
#alleles existing
rownames(sp_all_exist_df) <- paste0(c(1:10), " or more copies")
colnames(sp_all_exist_df) <- list_allele_cat
#percent capture of allele types by gardens
rownames(sp_wild_cap_df) <- paste0(c(1:10), " or more copies")
colnames(sp_wild_cap_df) <- list_allele_cat
#comparison of percent of wild alleles captured in garden
rownames(sp_allele_cap) <- paste0(c(1:10), " or more copies")
colnames(sp_allele_cap) <- list_allele_cat
##write out data frames
write.csv(sp_all_exist_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_all_exist2", n_drop_file, ".csv"))
write.csv(sp_wild_cap_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_wildcap2", n_drop_file, ".csv"))
write.csv(sp_allele_cap, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_all_cap2", n_drop_file, ".csv"))
}
}
sp_ind_rep_df
sp_ind_rep_df <- matrix(nrow = (length(dup_reps)), ncol = length(list_allele_cat))
num_rep_list <- list(list(), list(), list(), list(),
list(), list(), list(), list(),
list())
num_rep_red_list<- list(list(), list(), list(), list(),
list(), list(), list(), list(),
list())
sp_ind_rep_red_df <- matrix(nrow = (length(dup_reps)), ncol = length(list_allele_cat))
sp_ind_red_rep_df
sp_ind_rep_df <- matrix(nrow = (length(dup_reps)), ncol = length(list_allele_cat))
num_rep_list <- list(list(), list(), list(), list(),
list(), list(), list(), list(),
list())
num_rep_red_list<- list(list(), list(), list(), list(),
list(), list(), list(), list(),
list())
sp_ind_rep_red_df <- matrix(nrow = (length(dup_reps)), ncol = length(list_allele_cat))
##run loop to generate allelic capture table
#the outer loop is calculating how many copies of each allele in each category exists
#the inner loop is calculating the percent capture of each allele in each frequency category
for(sp in 1:length(species_list)){  #loop over every scenario
for(ndrop in c(0,2)){     #loop to include very rare or not
#ndrop or not
if(ndrop == 0) n_drop_file <- "_ndrop0"
if(ndrop == 2) n_drop_file <- "_ndrop2"
#load genepop files as genind objects
sp_genind_temp <- read.genepop(paste0("Adegenet_Files/",sp_genind_list[[sp]]), ncode = 3)
#load data frames
sp_df_temp <- read.csv(paste0("CSV_Files/", sp_df_list[[sp]]))
##organize genind object
#add individual names to each row of the tab
rownames(sp_genind_temp@tab) <- sp_df_temp[,1]
#add pop names to the genind object
levels(sp_genind_temp@pop) <- unique(sp_df_temp$Pop)
##organize into pops - garden
#sp_garden_genind <- repool(seppop(sp_genind_temp)[pop_list[[sp]]])
#rename pops to be garden only
#levels(sp_garden_genind@pop) <- rep("Garden", length(levels(sp_garden_genind@pop)))
sp_garden_ind <- sum(table(sp_genind_temp@pop)[pop_list[[sp]]])
sp_garden_genind <- sp_genind_temp[1:sp_garden_ind,]
levels(sp_garden_genind@pop) <- rep("Garden", length(levels(sp_garden_genind@pop)))
##organize into pop types
#separate into wild genind object
#sp_wild_genind <- repool(seppop(sp_genind_temp)[pop_list[[sp+5]]])
#rename
#levels(sp_wild_genind@pop) <- rep("Wild", length(levels(sp_wild_genind@pop)))
sp_wild_ind <- sum(table(sp_genind_temp@pop)[pop_list[[sp+5]]])
sp_wild_genind <- sp_genind_temp[(sp_garden_ind+1):(sp_garden_ind+sp_wild_ind),]
levels(sp_wild_genind@pop) <- rep("Wild", length(levels(sp_wild_genind@pop)))
#repool genind objects
sp_garden_wild_genind <- repool(sp_garden_genind, sp_wild_genind)
#convert the wild genind object to a genpop object
sp_wild_genpop <- genind2genpop(seppop(sp_garden_wild_genind)[2]$Wild)
#create documents for comparison
#n_ind_W <- nrow(sp_wild_genind@tab);  n_ind_G <- nrow(sp_garden_genind@tab);
sp_alleles_cap <- colSums(seppop(sp_garden_wild_genind)[[1]]@tab,na.rm=T)
#first calculate the frequency categories of alleles in the wild individuals
sp_allele_cat <- get.allele.cat(sp_wild_genpop, 1, 1, n_ind_W, n_drop = ndrop, glob_only = TRUE)
#exterior loop to look at alleles by frequency category
#interior loop to alleles by "duplication" amount - how many copies of each allele
for(cat in 1:length(list_allele_cat)){
for(dup in 1:length(dup_reps)){
#calculating alleles that exist by allelic category
sp_all_exist_df[dup, cat] <- sum(sp_wild_genpop@tab[sp_allele_cat[[cat]]] > dup_reps[[dup]])
#now determine how many wild alleles were captured per category
sp_wild_cap_df[dup, cat] <- round(sum(sp_alleles_cap[sp_allele_cat[[cat]]] > dup_reps[[dup]])/length(sp_allele_cat[[cat]]),4)
#code to store as one data frame
sp_allele_cap[dup, cat] <- paste0(signif((sp_wild_cap_df[dup,cat]*100),3), "%")
##try to add the individual rep
#save alleles existing
num_alleles_in_cat <- length(sp_allele_cat[[cat]])
#save each category
for(a in 1:num_alleles_in_cat){
num_rep_list[[cat]][a] <- sum(sp_garden_genind@tab[,sp_allele_cat[[cat]]][,a] > 0, na.rm=T)
}
#save data frame with
sp_ind_rep_df[dup,cat] <- sum(num_rep_list[[cat]]>dup_reps[[dup]], na.rm = TRUE)/length(num_rep_list[[cat]])
}
}
#write out ind rep df
write.csv(sp_ind_rep_df, paste0("../Analyses/Results/Garden_Wild_Comparison/", species_list[[sp]], "_sp_ind_rep_df", n_drop_file, ".csv"))
#add loop to calculate diversity in ZAIN without small pops
if(sp == 3|sp == 4|sp == 5){
#loop to remove small pops from ZAIN and run diversity representation code
for(pop in 1:length(ZAIN_wild_red_list)){
##organize into pop types
#separate into wild genind object
sp_wild_red_genind <- repool(seppop(sp_genind_temp)[ZAIN_wild_red_list[[pop]]])
#rename
levels(sp_wild_red_genind@pop) <- rep("Wild", length(levels(sp_wild_red_genind@pop)))
#repool genind objects
sp_garden_wild_red_genind <- repool(sp_garden_genind, sp_wild_red_genind)
#convert the wild genind object to a genpop object
sp_wild_red_genpop <- genind2genpop(seppop(sp_garden_wild_red_genind)[2]$Wild)
#create documents for comparison
n_ind_W <- nrow(sp_wild_red_genind@tab);  n_ind_G <- nrow(sp_garden_genind@tab);
sp_alleles_red_cap <- colSums(seppop(sp_garden_wild_red_genind)[[1]]@tab,na.rm=T)
#first calculate the frequency categories of alleles in the wild individuals
sp_allele_red_cat <- get.allele.cat(sp_wild_red_genpop, 1, 1, n_ind_W, n_drop = ndrop, glob_only = TRUE)
#exterior loop to look at alleles by frequency category
#interior loop to alleles by "duplication" amount - how many copies of each allele
for(cat in 1:length(list_allele_cat)){
for(dup in 1:length(dup_reps)){
#calculating alleles that exist by allelic category in the wild
sp_all_red_exist_df[dup, cat] <- sum(sp_wild_red_genpop@tab[sp_allele_cat[[cat]]] > dup_reps[[dup]])
#now determine how many wild alleles were captured per category
sp_wild_red_cap_df[dup, cat] <- round(sum(sp_alleles_red_cap[sp_allele_red_cat[[cat]]] > dup_reps[[dup]])/length(sp_allele_red_cat[[cat]]),4)
#code to store as one data frame
sp_allele_red_cap[dup, cat] <- paste0(signif((sp_wild_red_cap_df[dup,cat]*100),3), "%")
#reduced alleles/cat
num_alleles_red_in_cat <- length(sp_allele_red_cat[[cat]])
#save each category
for(a in 1:num_alleles_red_in_cat){
num_rep_red_list[[cat]][a] <- sum(sp_garden_genind@tab[,sp_allele_red_cat[[cat]]][,a] > 0, na.rm=T)
}
#save data frame with
sp_ind_rep_red_df[dup,cat] <- sum(num_rep_red_list[[cat]]>dup_reps[[dup]], na.rm = TRUE)/length(num_rep_red_list[[cat]])
}
}
}
#without ZAIN small pops - alleles existing
rownames(sp_all_red_exist_df) <- paste0(c(1:10), " or more copies")
colnames(sp_all_red_exist_df) <- list_allele_cat
#without ZAIN small pops - representing alleles
rownames(sp_wild_red_cap_df) <- paste0(c(1:10), " or more copies")
colnames(sp_wild_red_cap_df) <- list_allele_cat
#without ZAIN small pops - comparing wild allele representation ex situ
rownames(sp_allele_red_cap) <- paste0(c(1:10), " or more copies")
colnames(sp_allele_red_cap) <- list_allele_cat
#ind per df
rownames(sp_ind_per) <- paste0(c(1:10), " or more copies")
colnames(sp_ind_per) <- list_allele_cat
write.csv(sp_all_red_exist_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_all_exist2", n_drop_file, "_wo_smallpops.csv"))
write.csv(sp_wild_red_cap_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_wildcap2", n_drop_file, "_wo_smallpops.csv"))
write.csv(sp_allele_red_cap, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_all_cap2", n_drop_file, "_wo_smallpops.csv"))
write.csv(sp_ind_rep_red_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_sp_ind_rep_red_df", n_drop_file, "_wo_smallpops.csv"))
}
##format tables
#alleles existing
rownames(sp_all_exist_df) <- paste0(c(1:10), " or more copies")
colnames(sp_all_exist_df) <- list_allele_cat
#percent capture of allele types by gardens
rownames(sp_wild_cap_df) <- paste0(c(1:10), " or more copies")
colnames(sp_wild_cap_df) <- list_allele_cat
#comparison of percent of wild alleles captured in garden
rownames(sp_allele_cap) <- paste0(c(1:10), " or more copies")
colnames(sp_allele_cap) <- list_allele_cat
##write out data frames
write.csv(sp_all_exist_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_all_exist2", n_drop_file, ".csv"))
write.csv(sp_wild_cap_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_wildcap2", n_drop_file, ".csv"))
write.csv(sp_allele_cap, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_all_cap2", n_drop_file, ".csv"))
}
}
##run loop to generate allelic capture table
#the outer loop is calculating how many copies of each allele in each category exists
#the inner loop is calculating the percent capture of each allele in each frequency category
for(sp in 1:length(species_list)){  #loop over every scenario
for(ndrop in c(0,2)){     #loop to include very rare or not
#ndrop or not
if(ndrop == 0) n_drop_file <- "_ndrop0"
if(ndrop == 2) n_drop_file <- "_ndrop2"
#load genepop files as genind objects
sp_genind_temp <- read.genepop(paste0("Adegenet_Files/",sp_genind_list[[sp]]), ncode = 3)
#load data frames
sp_df_temp <- read.csv(paste0("CSV_Files/", sp_df_list[[sp]]))
##organize genind object
#add individual names to each row of the tab
rownames(sp_genind_temp@tab) <- sp_df_temp[,1]
#add pop names to the genind object
levels(sp_genind_temp@pop) <- unique(sp_df_temp$Pop)
##organize into pops - garden
#sp_garden_genind <- repool(seppop(sp_genind_temp)[pop_list[[sp]]])
#rename pops to be garden only
#levels(sp_garden_genind@pop) <- rep("Garden", length(levels(sp_garden_genind@pop)))
sp_garden_ind <- sum(table(sp_genind_temp@pop)[pop_list[[sp]]])
sp_garden_genind <- sp_genind_temp[1:sp_garden_ind,]
levels(sp_garden_genind@pop) <- rep("Garden", length(levels(sp_garden_genind@pop)))
##organize into pop types
#separate into wild genind object
#sp_wild_genind <- repool(seppop(sp_genind_temp)[pop_list[[sp+5]]])
#rename
#levels(sp_wild_genind@pop) <- rep("Wild", length(levels(sp_wild_genind@pop)))
sp_wild_ind <- sum(table(sp_genind_temp@pop)[pop_list[[sp+5]]])
sp_wild_genind <- sp_genind_temp[(sp_garden_ind+1):(sp_garden_ind+sp_wild_ind),]
levels(sp_wild_genind@pop) <- rep("Wild", length(levels(sp_wild_genind@pop)))
#repool genind objects
sp_garden_wild_genind <- repool(sp_garden_genind, sp_wild_genind)
#convert the wild genind object to a genpop object
sp_wild_genpop <- genind2genpop(seppop(sp_garden_wild_genind)[2]$Wild)
#create documents for comparison
#n_ind_W <- nrow(sp_wild_genind@tab);  n_ind_G <- nrow(sp_garden_genind@tab);
sp_alleles_cap <- colSums(seppop(sp_garden_wild_genind)[[1]]@tab,na.rm=T)
#first calculate the frequency categories of alleles in the wild individuals
sp_allele_cat <- get.allele.cat(sp_wild_genpop, 1, 1, n_ind_W, n_drop = ndrop, glob_only = TRUE)
#exterior loop to look at alleles by frequency category
#interior loop to alleles by "duplication" amount - how many copies of each allele
for(cat in 1:length(list_allele_cat)){
for(dup in 1:length(dup_reps)){
#calculating alleles that exist by allelic category
sp_all_exist_df[dup, cat] <- sum(sp_wild_genpop@tab[sp_allele_cat[[cat]]] > dup_reps[[dup]])
#now determine how many wild alleles were captured per category
sp_wild_cap_df[dup, cat] <- round(sum(sp_alleles_cap[sp_allele_cat[[cat]]] > dup_reps[[dup]])/length(sp_allele_cat[[cat]]),4)
#code to store as one data frame
sp_allele_cap[dup, cat] <- paste0(signif((sp_wild_cap_df[dup,cat]*100),3), "%")
##try to add the individual rep
#save alleles existing
num_alleles_in_cat <- length(sp_allele_cat[[cat]])
#save each category
for(a in 1:num_alleles_in_cat){
num_rep_list[[cat]][a] <- sum(sp_garden_genind@tab[,sp_allele_cat[[cat]]][,a] > 0, na.rm=T)
}
#save data frame with
sp_ind_rep_df[dup,cat] <- sum(num_rep_list[[cat]]>dup_reps[[dup]], na.rm = TRUE)/length(num_rep_list[[cat]])
}
}
#write out ind rep df
write.csv(sp_ind_rep_df, paste0("../Analyses/Results/Garden_Wild_Comparison/", species_list[[sp]], "_sp_ind_rep_df", n_drop_file, ".csv"))
#add loop to calculate diversity in ZAIN without small pops
if(sp == 3|sp == 4|sp == 5){
#loop to remove small pops from ZAIN and run diversity representation code
for(pop in 1:length(ZAIN_wild_red_list)){
##organize into pop types
#separate into wild genind object
sp_wild_red_genind <- repool(seppop(sp_genind_temp)[ZAIN_wild_red_list[[pop]]])
#rename
levels(sp_wild_red_genind@pop) <- rep("Wild", length(levels(sp_wild_red_genind@pop)))
#repool genind objects
sp_garden_wild_red_genind <- repool(sp_garden_genind, sp_wild_red_genind)
#convert the wild genind object to a genpop object
sp_wild_red_genpop <- genind2genpop(seppop(sp_garden_wild_red_genind)[2]$Wild)
#create documents for comparison
n_ind_W <- nrow(sp_wild_red_genind@tab);  n_ind_G <- nrow(sp_garden_genind@tab);
sp_alleles_red_cap <- colSums(seppop(sp_garden_wild_red_genind)[[1]]@tab,na.rm=T)
#first calculate the frequency categories of alleles in the wild individuals
sp_allele_red_cat <- get.allele.cat(sp_wild_red_genpop, 1, 1, n_ind_W, n_drop = ndrop, glob_only = TRUE)
#exterior loop to look at alleles by frequency category
#interior loop to alleles by "duplication" amount - how many copies of each allele
for(cat in 1:length(list_allele_cat)){
for(dup in 1:length(dup_reps)){
#calculating alleles that exist by allelic category in the wild
sp_all_red_exist_df[dup, cat] <- sum(sp_wild_red_genpop@tab[sp_allele_cat[[cat]]] > dup_reps[[dup]])
#now determine how many wild alleles were captured per category
sp_wild_red_cap_df[dup, cat] <- round(sum(sp_alleles_red_cap[sp_allele_red_cat[[cat]]] > dup_reps[[dup]])/length(sp_allele_red_cat[[cat]]),4)
#code to store as one data frame
sp_allele_red_cap[dup, cat] <- paste0(signif((sp_wild_red_cap_df[dup,cat]*100),3), "%")
#reduced alleles/cat
num_alleles_red_in_cat <- length(sp_allele_red_cat[[cat]])
#save each category
for(a in 1:num_alleles_red_in_cat){
num_rep_red_list[[cat]][a] <- sum(sp_garden_genind@tab[,sp_allele_red_cat[[cat]]][,a] > 0, na.rm=T)
}
#save data frame with
sp_ind_rep_red_df[dup,cat] <- sum(num_rep_red_list[[cat]]>dup_reps[[dup]], na.rm = TRUE)/length(num_rep_red_list[[cat]])
}
}
}
#without ZAIN small pops - alleles existing
rownames(sp_all_red_exist_df) <- paste0(c(1:10), " or more copies")
colnames(sp_all_red_exist_df) <- list_allele_cat
#without ZAIN small pops - representing alleles
rownames(sp_wild_red_cap_df) <- paste0(c(1:10), " or more copies")
colnames(sp_wild_red_cap_df) <- list_allele_cat
#without ZAIN small pops - comparing wild allele representation ex situ
rownames(sp_allele_red_cap) <- paste0(c(1:10), " or more copies")
colnames(sp_allele_red_cap) <- list_allele_cat
#ind per df
rownames(sp_ind_per) <- paste0(c(1:10), " or more copies")
colnames(sp_ind_per) <- list_allele_cat
write.csv(sp_all_red_exist_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_all_exist2", n_drop_file, "_wo_smallpops.csv"))
write.csv(sp_wild_red_cap_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_wildcap2", n_drop_file, "_wo_smallpops.csv"))
write.csv(sp_allele_red_cap, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_all_cap2", n_drop_file, "_wo_smallpops.csv"))
write.csv(sp_ind_rep_red_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_sp_ind_rep_red_df", n_drop_file, "_wo_smallpops.csv"))
}
##format tables
#alleles existing
rownames(sp_all_exist_df) <- paste0(c(1:10), " or more copies")
colnames(sp_all_exist_df) <- list_allele_cat
#percent capture of allele types by gardens
rownames(sp_wild_cap_df) <- paste0(c(1:10), " or more copies")
colnames(sp_wild_cap_df) <- list_allele_cat
#comparison of percent of wild alleles captured in garden
rownames(sp_allele_cap) <- paste0(c(1:10), " or more copies")
colnames(sp_allele_cap) <- list_allele_cat
##write out data frames
write.csv(sp_all_exist_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_all_exist2", n_drop_file, ".csv"))
write.csv(sp_wild_cap_df, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_wildcap2", n_drop_file, ".csv"))
write.csv(sp_allele_cap, paste0("../Analyses/Results/Garden_Wild_Comparison/",species_list[[sp]], "_all_cap2", n_drop_file, ".csv"))
}
}
for(dup in dup_reps){
for(cat in 1:length(QUAC_all_cat)){
#create data frame to store results
QUAC_rep_df[dup+1,cat] <- sum(num_rep_list[[cat]]>dup)/length(num_rep_list[[cat]])
QUAC_rep_df_he[dup+1,cat] <- sum(num_rep_list_he[[cat]]>dup)/length(QUAC_all_cat[[cat]])
QUAC_rep_df_ho[dup+1,cat] <- sum(num_rep_list_ho[[cat]]>dup)/length(QUAC_all_cat[[cat]])
}
}
for(cat in 1:length(QUAC_all_cat)){
num_alleles_in_cat <- length(QUAC_all_cat[[cat]])
for (a in 1:num_alleles_in_cat){
num_rep_list[[cat]][a] <- sum(QUAC_garden_genind@tab[,QUAC_all_cat[[cat]]][,a] > 0, na.rm=T)
num_rep_list_he[[cat]][a] <- sum(QUAC_garden_genind@tab[,QUAC_all_cat[[cat]]][,a] == 1, na.rm=T)
num_rep_list_ho[[cat]][a] <- sum(QUAC_garden_genind@tab[,QUAC_all_cat[[cat]]][,a] == 2, na.rm=T)
}
}
#create data frame to save results
QUAC_rep_df <- matrix(nrow = length(dup_reps),
ncol = length(QUAC_all_cat))
QUAC_rep_df_he <- matrix(nrow = length(dup_reps),
ncol = length(QUAC_all_cat))
QUAC_rep_df_ho <- matrix(nrow = length(dup_reps),
ncol = length(QUAC_all_cat))
for(dup in dup_reps){
for(cat in 1:length(QUAC_all_cat)){
#create data frame to store results
QUAC_rep_df[dup+1,cat] <- sum(num_rep_list[[cat]]>dup)/length(num_rep_list[[cat]])
QUAC_rep_df_he[dup+1,cat] <- sum(num_rep_list_he[[cat]]>dup)/length(QUAC_all_cat[[cat]])
QUAC_rep_df_ho[dup+1,cat] <- sum(num_rep_list_ho[[cat]]>dup)/length(QUAC_all_cat[[cat]])
}
}
#write out matrix
QUAC_rep_df <- signif(QUAC_rep_df*100,3)
colnames(QUAC_rep_df) <- all_cat_list
rownames(QUAC_rep_df) <- paste0(c(1:10), " or more copies")
write.csv(QUAC_rep_df, "../Analyses/Results/Garden_Wild_Comparison/QUAC_rep_df.csv")
#allele categories list
all_cat_list <-c("global","glob_v_com","glob_com","glob_lowfr","glob_rare")
for(dup in dup_reps){
for(cat in 1:length(QUAC_all_cat)){
#create data frame to store results
QUAC_rep_df[dup+1,cat] <- sum(num_rep_list[[cat]]>dup)/length(num_rep_list[[cat]])
QUAC_rep_df_he[dup+1,cat] <- sum(num_rep_list_he[[cat]]>dup)/length(QUAC_all_cat[[cat]])
QUAC_rep_df_ho[dup+1,cat] <- sum(num_rep_list_ho[[cat]]>dup)/length(QUAC_all_cat[[cat]])
}
}
#write out matrix
QUAC_rep_df <- signif(QUAC_rep_df*100,3)
colnames(QUAC_rep_df) <- all_cat_list
rownames(QUAC_rep_df) <- paste0(c(1:10), " or more copies")
write.csv(QUAC_rep_df, "../Analyses/Results/Garden_Wild_Comparison/QUAC_rep_df.csv")
#write out matrix
QUAC_rep_df_he <- signif(QUAC_rep_df_he*100,3)
colnames(QUAC_rep_df_he) <- all_cat_list
rownames(QUAC_rep_df_he) <- paste0(c(1:10), " or more copies")
write.csv(QUAC_rep_df_he, "../Analyses/Results/Garden_Wild_Comparison/QUAC_rep_df_he.csv")
write.csv(QUAC_rep_df, "../Analyses/Results/Garden_Wild_Comparison/QUAC_rep_df.csv")
write.csv(QUAC_rep_df_he, "../Analyses/Results/Garden_Wild_Comparison/QUAC_rep_df_he.csv")
write.csv(QUAC_rep_df_ho, "../Analyses/Results/Garden_Wild_Comparison/QUAC_rep_df_ho.csv")
#write out matrix
QUAC_rep_df <- signif(QUAC_rep_df,3)
colnames(QUAC_rep_df) <- all_cat_list
rownames(QUAC_rep_df) <- paste0(c(1:10), " or more copies")
#write out matrix
QUAC_rep_df_he <- signif(QUAC_rep_df_he,3)
colnames(QUAC_rep_df_he) <- all_cat_list
rownames(QUAC_rep_df_he) <- paste0(c(1:10), " or more copies")
QUAC_rep_df_ho <- signif(QUAC_rep_df_ho,3)
colnames(QUAC_rep_df_ho) <- all_cat_list
rownames(QUAC_rep_df_ho) <- paste0(c(1:10), " or more copies")
write.csv(QUAC_rep_df, "../Analyses/Results/Garden_Wild_Comparison/QUAC_rep_df.csv")
write.csv(QUAC_rep_df_he, "../Analyses/Results/Garden_Wild_Comparison/QUAC_rep_df_he.csv")
write.csv(QUAC_rep_df_ho, "../Analyses/Results/Garden_Wild_Comparison/QUAC_rep_df_ho.csv")
QUAC_rep_df_he
for(dup in dup_reps){
for(cat in 1:length(QUAC_all_cat)){
#create data frame to store results
QUAC_rep_df[dup+1,cat] <- sum(num_rep_list[[cat]]>dup)/length(num_rep_list[[cat]])
QUAC_rep_df_he[dup+1,cat] <- sum(num_rep_list_he[[cat]]>dup)/length(QUAC_all_cat[[cat]])
QUAC_rep_df_ho[dup+1,cat] <- sum(num_rep_list_ho[[cat]]>dup)/length(QUAC_all_cat[[cat]])
}
}
#write out matrix
QUAC_rep_df <- signif(QUAC_rep_df,3)
colnames(QUAC_rep_df) <- all_cat_list
rownames(QUAC_rep_df) <- paste0(c(1:10), " or more copies")
#write out matrix
QUAC_rep_df_he <- signif(QUAC_rep_df_he,3)
colnames(QUAC_rep_df_he) <- all_cat_list
rownames(QUAC_rep_df_he) <- paste0(c(1:10), " or more copies")
QUAC_rep_df_ho <- signif(QUAC_rep_df_ho,3)
colnames(QUAC_rep_df_ho) <- all_cat_list
rownames(QUAC_rep_df_ho) <- paste0(c(1:10), " or more copies")
write.csv(QUAC_rep_df, "../Analyses/Results/Garden_Wild_Comparison/QUAC_rep_df.csv")
write.csv(QUAC_rep_df_he, "../Analyses/Results/Garden_Wild_Comparison/QUAC_rep_df_he.csv")
write.csv(QUAC_rep_df_ho, "../Analyses/Results/Garden_Wild_Comparison/QUAC_rep_df_ho.csv")
